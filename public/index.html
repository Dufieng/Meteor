<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Meteor</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>My espMeteor</h1>
<ul id="list"></ul>

<canvas id="chart"></canvas>

<script>
document.addEventListener("DOMContentLoaded", function() {
  fetch("/api/data")
    .then(r => {
      if (!r.ok) throw new Error("API error: " + r.status);
      return r.json();
    })
    .then(data => {
      data.reverse(); // щоб час ішов зліва направо

      const labels = data.map(d => d.time);
      const temps = data.map(d => d.temperature);

      const ctx = document.getElementById("chart");
      if (!ctx) {
        console.error("Canvas element not found!");
        return;
      }

      new Chart(ctx, {
        type: "line",
        data: {
          labels: labels,
          datasets: [{
            label: "Температура °C",
            data: temps
          }]
        }
      });
    })
    .catch(error => {
      console.error("Error loading chart:", error);
      document.body.innerHTML += "<p style='color:red'>Помилка завантаження даних: " + error.message + "</p>";
    });
});
</script>


</body>
</html>

